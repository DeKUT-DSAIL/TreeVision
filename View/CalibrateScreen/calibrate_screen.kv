<CalibrateScreenView>:

    FloatLayout:
        size: root.size

        FloatLayout:
            size_hint_y: .6
            pos_hint: {'top': 1}

            # left and right images
            MDBoxLayout:
                pos_hint: {'top': 1}

                AnchorLayout:
                    anchor_x: 'left'
                    Image:
                        id: left_image 
                        source: "assets/images/calibration/pattern_cropped.png"
                        size: self.texture_size
                        allow_stretch: True
                AnchorLayout:
                    anchor_x: 'right'
                    Image:
                        id: right_image
                        source: "assets/images/calibration/pattern_cropped.png"
                        size: self.texture_size
                        allow_stretch: True
            
            # OVERLAY ON THE IMAGES
            FloatLayout:
                id: overlay_layout
                pos_hint: {'y': 0}
                size_hint_y: None
                height: self.parent.height * 0.15

                Widget:
                    id: overlay
                    canvas.before:
                        Color:
                            rgba: 0,0,0,0.5
                        Rectangle:
                            pos: self.parent.pos
                            size: self.parent.size
        
                MDIconButton:
                    id: previous_arrow
                    icon: 'arrow-left-circle-outline'
                    md_bg_color: app.theme_cls.primary_color
                    pos_hint: {"center_x": .47, "center_y": .5}


                MDIconButton:
                    id: next_arrow
                    icon: 'arrow-right-circle-outline'
                    md_bg_color: app.theme_cls.primary_color
                    pos_hint: {"center_x": .53, "center_y": .5}
                

                MDIconButton:
                    id: reset
                    icon: 'cog-refresh-outline'
                    widget_style: 'ios'
                    theme_icon_color: 'Custom'
                    icon_color: 'white'
                    md_bg_color: .15, .65, .9, 1
                    pos_hint: {"center_x": .95, "center_y": .5}
                    on_release: root.controller.reset()
            

        # CONFIGURATIONS AND LOGGING
        MDBoxLayout:
            size_hint: 1, 0.05
            pos_hint: {'top': 0.395}
            padding: "10dp", "10dp"
            md_bg_color: app.theme_cls.primary_color
            MDLabel:
                text: "Configurations"
        

        MDBoxLayout:
            orientation: "horizontal"
            size_hint: 1, 0.3
            pos_hint: {'top': 0.345}

            # COLUMN 1: LOADING IMAGES
            MDBoxLayout:
                orientation: "vertical"
                size_hint_x: 0.8
                padding: "10dp", "10dp"
                spacing: dp(10)
                MDBoxLayout:
                    # size_hint_y: None
                    # height: "30dp"
                    spacing: dp(0)
                    AnchorLayout:
                        anchor_x: 'left'
                        MDLabel:
                            text: "Project name: "
                            color: 0, 0, 0, 1
                    AnchorLayout:
                        anchor_x: 'right'
                        TextInput:
                            id: project_name
                            multiline: False
                
                MDBoxLayout:
                    spacing: dp(0)
                    AnchorLayout:
                        anchor_x: 'left'
                        MDLabel:
                            text: "Images folder:"
                    AnchorLayout:
                        anchor_x: 'right'
                        MDRectangleFlatIconButton:
                            id: images_select
                            text: "Select"
                            icon: "folder"
                            size_hint_x: 1
                            on_release: root.controller.file_manager_open('folder')
                
                MDBoxLayout:
                    spacing: dp(10)
                    AnchorLayout:
                        anchor_x: 'left'
                        MDLabel:
                            text: "Type: "
                    AnchorLayout:
                        anchor_x: 'right'
                        MDDropDownItem:
                            id: calib_type_dropdown_item
                            size_hint_x: 1
                            pos_hint: {'center_x': .5, 'center_y': .5}
                            text: 'Select calibration type'
                            background_color: [1,0,0,1]
                            on_release: root.controller.calib_type_menu.open() 
                
                MDBoxLayout:
                    spacing: dp(10)
                    AnchorLayout:
                        anchor_x: 'left'
                        MDLabel:
                            text: "Calibration filename:"
                    AnchorLayout:
                        anchor_x: 'right'
                        TextInput:
                            id: save_file
                            multiline: False
                            text: "sample"

            MDBoxLayout:
                orientation: "vertical"
                size_hint_x: 0.8
                padding: '10dp', '10dp'
                spacing: dp(10)
                MDBoxLayout:
                    spacing: dp(10)
                    AnchorLayout:
                        anchor_x: "left"
                        MDLabel:
                            text: "Image dimensions (pixels):"
                    AnchorLayout:
                        anchor_x: "center"
                        size_hint_x: 0.5
                        MDBoxLayout:
                            MDLabel:
                                text: "W:"
                            TextInput:
                                id: image_width
                                multiline: False
                                text: "1280"
                    AnchorLayout:
                        anchor_x: "right"
                        size_hint_x: 0.5
                        MDBoxLayout:
                            MDLabel:
                                text: "H:"
                            TextInput:
                                id: image_height
                                multiline: False
                                text: "720"
                MDBoxLayout:
                    spacing: dp(10)
                    AnchorLayout:
                        anchor_x: "left"
                        MDLabel:
                            text: "Pattern dimensions:"
                    AnchorLayout:
                        anchor_x: "center"
                        size_hint_x: 0.5
                        MDBoxLayout:
                            MDLabel:
                                text: "W:"
                            TextInput:
                                id: pattern_width
                                multiline: False
                                text: "9"
                    AnchorLayout:
                        anchor_x: "right"
                        size_hint_x: 0.5
                        MDBoxLayout:
                            MDLabel:
                                text: "H:"
                            TextInput:
                                id: pattern_height
                                multiline: False
                                text: "6"

                MDBoxLayout:
                    AnchorLayout:
                        anchor_x: "left"
                        MDLabel:
                            text: "Square size (mm)"
                    AnchorLayout:
                        anchor_x: "right"
                        TextInput:
                            id: square_size
                            multilin: False
                            text: "24.5"
                
                MDBoxLayout:
                    AnchorLayout:
                        anchor_x: "left"
                        MDRaisedButton:
                            text: "Calibrate Single"
                            md_bg_color: "green"
                            on_release: root.controller.update_on_calibrate()
                    AnchorLayout:
                        anchor_x: "right"
                        MDRaisedButton:
                            text: "Calibrate Stereo"
                            md_bg_color: "green"
                            on_release: root.controller.update_on_calibrate()

            
            # COLUMN 3: LOGGING INFORMATION
            MDBoxLayout:
                orientation: 'vertical'
                MDProgressBar:
                    id: progress_bar
                    color: "green"
                    size_hint_y: 0.3
                    max: 100
                    value: 5
                MDScrollView:  
                    id: scrollview
                    MDBoxLayout:
                        id: scroll_layout
                        orientation: 'vertical'
                        md_bg_color: 0, 0, 0, 1
                        size_hint: 1, None
                        spacing: 50
                        padding: 10, 50
                        height: self.minimum_height

        # This is the bottom strip
        MDBoxLayout:
            size_hint: 1, 0.045
            pos_hint: {"top": 0.045}
            md_bg_color: app.theme_cls.primary_dark
            
        MDFloatingActionButtonSpeedDial:
            id: speed_dial
            data: app.modules
            root_button_anim: True
            hint_animation: True
            bg_color_root_button: "teal"
            bg_color_stack_button: "teal"
            bg_hint_color: "teal"
            label_text_color: "white"
            color_icon_root_button: "white"
            color_icon_stack_button: "white"
